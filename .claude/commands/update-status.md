# /update-status - 自动更新项目状态

作为项目状态管理助手，请帮我自动更新项目状态文档。

## 你需要做的：

1. **读取现有状态**
   - 读取 `docs/项目状态.md`
   - 了解当前记录的状态

2. **查看最近提交**
   - 查看最近 10 条 Git 提交记录
   - 分析完成了哪些功能

3. **扫描项目模块**
   - 扫描 `lib/` 目录下的所有模块
   - 识别新增或修改的功能

4. **统计模块完成度**
   - 检查每个功能模块的完整性
   - 计算完成度百分比

5. **扫描待办事项**
   - 扫描代码中的 TODO/FIXME 注释
   - 识别新的待办任务

6. **智能更新文档**
   - 将新完成的任务移到"已完成"区域
   - 更新"进行中"任务的进度
   - 添加新发现的待办任务
   - 更新整体进度百分比
   - 更新时间戳
   - 更新 `docs/项目状态.md`和`docs/待办清单.md`

7. **提交git记录**
   - 调用 /zcf:git-commit 命令，执行git commit

## 更新规则：

### 判断任务完成的标准

**功能模块完成**：
- 相关的 Model 类已创建
- 相关的 Provider 已实现
- 相关的 Screen/Widget 已创建
- 相关的 Service 已实现
- 有对应的 Git 提交记录

**任务进行中**：
- 有部分代码已提交
- 但功能尚未完整实现
- 或有 TODO 注释标记未完成部分

**新增待办**：
- 代码中新增的 TODO/FIXME 注释
- Git 提交信息中提到的后续任务

### 保留用户内容

- ✅ 保留用户手动添加的任务
- ✅ 保留用户自定义的备注和说明
- ✅ 保留用户手动调整的优先级
- ✅ 只更新可以从代码分析出的内容

## 输出格式：

```
# 📝 项目状态更新报告

生成时间: [当前时间]

## 本次更新内容
- ✅ 新增已完成任务：[X] 项
- 🚧 更新进行中任务：[X] 项
- 📋 新增待办任务：[X] 项

## 主要变更

### 1. [功能模块名称]：从 [原状态] → [新状态]
   - 完成时间：[时间]
   - 完成内容：[具体内容]
   - Git 提交：`[提交信息]`

### 2. [功能模块名称]：新增进行中任务
   - 当前进度：[X%]
   - 位置：[文件路径]
   - 预计完成时间：[时间]

### 3. 新增待办任务：[任务名称]
   - 来源：[代码扫描/Git 提交]
   - 优先级：[高/中/低]
   - 位置：[文件路径]

## 📊 进度变化

- 整体进度：[旧进度]% → **[新进度]%** ↑ (+[差值]%)
- [模块名称]: [旧进度]% → **[新进度]%**
- [模块名称]: [旧进度]% → **[新进度]%**

## 📈 模块完成度更新

[列出各模块的完成度变化]

## 🔍 新发现的 TODO/FIXME

[列出新增的 TODO 和 FIXME 注释]

---

✅ 文档已更新：`docs/项目状态.md`

## 🎯 下一步建议

[基于更新后的状态，建议接下来做什么]
```

## 更新后的文档结构：

更新 `docs/项目状态.md`，保持以下结构：

```markdown
# Voice Book - 项目状态

最后更新: [当前时间]

## 📊 当前状态
- 项目阶段: [阶段]
- 整体进度: [X%]
- 下一步计划: [计划]

## ✅ 已完成

[按时间倒序列出已完成的任务]

- [x] [任务名称] (完成时间)
  - 耗时: [X天]
  - 说明: [说明]
  - Git: [提交信息]

## 🚧 进行中

[列出正在进行的任务]

- [ ] [任务名称] (开始: [时间])
  - 进度: [X%]
  - 预计完成: [时间]
  - 当前工作: [当前在做什么]
  - 位置: [文件路径]

## 📋 待办

[按优先级列出待办任务]

- [ ] [任务名称]
  - 优先级: [高/中/低]
  - 预计工作量: [X天]
  - 依赖: [依赖项]

## 📈 里程碑

[列出项目里程碑]

## 📊 模块完成度统计

[按模块统计完成度]

## 🔍 代码质量分析

[代码质量相关指标]

## 📝 最近更新

[记录本次更新的内容]

## 🎯 下一步行动

[建议接下来的行动]
```

## 注意事项：

- 更新要基于实际的代码扫描和 Git 提交，不要凭猜测
- 保留用户手动添加的内容，不要覆盖
- 进度百分比要准确计算，不要估算
- 更新报告要详细，让用户清楚知道变化了什么
- 如果没有明显变化，也要说明"本次扫描未发现重大变更"
